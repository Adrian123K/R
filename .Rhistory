skin2_train <- skin2_shuffle[1:train_num,  ]
skin2_test  <- skin2_shuffle[(train_num+1) : nrow(skin2_shuffle), ]
skin_model2 <- C5.0(skin2_train[  , -6],  skin2_train$cupon_react,trials=10 )
skin2_result  <- predict( skin_model2 , skin2_test[  , -6])
CrossTable( skin2_test[  , 6],  skin2_result )
credit <- read.csv("credit.csv",head=T)
str(credit)
credit <- read.csv("credit.csv",head=T,stringsAsFactors = T)
str(credit)
prop.table( table(credit$default)  )
summary( credit$amount)
str(credit)
set.seed(31)
credit_shuffle <-  credit[ sample( nrow(credit) ),  ]
train_num <- round( 0.9 * nrow(credit_shuffle), 0)
credit_train <- credit_shuffle[1:train_num ,  ]
credit_test  <- credit_shuffle[(train_num+1) : nrow(credit_shuffle),  ]
credit_model <- C5.0( credit_train[ ,-17] , credit_train[  , 17] )
credit_result <-  predict( credit_model, credit_test[  , -17] )
CrossTable(  credit_test[   , 17], credit_result )
#                ↑                     ↑
#              실제                   예측
rs <- CrossTable(  credit_test[   , 17], credit_result )
rs
rs[1,1]
credit_model
summary(credit_model)
skin_model
skin_model <- C5.0(skin2_train[  , -6],  skin2_train$cupon_react )
skin_model
summary(skin_model)
((-2/3)*log2(2/3)+(-1/3)*log2(1/3))*3/5
install.packages('caret')
install.packages('rpart')
install.packages("rpart")
install.packages('rpart.plot')
credit = read.csv('credit.csv',header=T,stringsAsFactors = T)
library(caret)
set.seed(5)
intrain = createDataPartition(credit$default,p=0.9,list=F)
credit_train = credit[intrain,]
credit_test = credit[-intrain,]
nrow(credit_train) # 900
nrow(credit_test) # 100
library(C50)
credit_model = C5.0(default~.,data=credit_train,trials=24) # 24 : 0.87
credit_result = predict(credit_model,credit_test[,-17])
library(gmodels)
x = CrossTable(credit_test[,17],credit_result)
library(rpart)
library(rpart.plot)
rpartmod = rpart(default~., data=credit_train, method='class')
rpart.plot(rpartmod)
x$prop.tbl[1]+x$prop.tbl[4] # 0.87
dev.new()
rpart.plot(rpartmod)
savePlot('dcs_tree.png', type='png')
getwd()
A <- matrix(c(1,2,3,4,5,6), nrow = 3, ncol = 2)
A
t(A)
inv(A)
A <- matrix(c(1,2,3,4,5,6), nrow = 3, ncol = 2)
t(A)
A
det(A)
b <- matrix(c(1,2,3,2,3,4),nrow=2,ncol=3)
b
i <- matrix(c(1,0,0,0,1,0,0,0,1),nrow=3,ncol=3)
b%*%i
b <- matrix(c(1,2,3,2,3,4),nrow=2,ncol=3, byrow=T)
i <- matrix(c(1,0,0,0,1,0,0,0,1),nrow=3,ncol=3)
b%*%i
i <- matrix(c(1,0,0,0,1,0,0,0,1),nrow=3,ncol=3, byrow=T)
b%*%i
A <- matrix(c(1,2,3,4,5,6), nrow = 3, ncol = 2, byrow=T)
A
t(A)
b <- matrix(c(1,2,3,2,3,4),nrow=2,ncol=3, byrow=T)
i <- matrix(c(1,0,0,0,1,0,0,0,1),nrow=3,ncol=3, byrow=T)
b%*%i
i <- diag(1,3,3)
b%*%i
i
t <- diag(3)
t
i <- diag(3)
b%*%i
invA <- (-1/3)*matrix(c(4,1,-2,-3),nrow=2,ncol=2,byrow=T)
invA
solve(A)
A <- matrix(c(1,2,3,4),nrow=2,ncol=2, byrow=T)
solve(A)
round(A %*% solve(A))
reg <- function(y, x){
x <- as.matrix(x)
x <- cbind(intercept=1,x)
b <- solve(t(x)%*%x)%*%t(x)%*%y
print(b)
}
launch <- read.csv('challenger.csv',head=T)
launch
reg(launch)
lnch2 <- launch[,-1]
lnch2
reg(y=launch$distress_ct,lnch2)
smp <- read.csv('multi_hg.csv',head=T)
smp
head(smp)
reg(smp$만족감,smp[,1:3])
attach(smp)
smp_model <- lm(만족감~외관+편의성+유용성,data=smp)
smp_model
subj <- read.csv('sports.csv',head=T)
head(subj)
reg(y=subj$acceptance,x=subj[,-1])
lm(acceptance~academic+sports+music,data=subj)
normalize<-function(x) {
return( (x-min(x))/ ( max(x)-min(x)))
}
acanor <- normalize(subj$academic)
acanor
as.data.frame(rs)
rs <- lapply(subj,normalize)
as.data.frame(rs)
rs <- as.data.frame(rs)
head(rs)
lm(acceptance~academic,data=rs)
lm(acceptance~.,data=rs)
subj2 <- subj[,-1]
rs <- lapply(subj,normalize)
rs <- as.data.frame(rs)
subj2 <- subj[,-1]
rs <- lapply(subj2,normalize)
rs <- as.data.frame(rs)
head(rs)
lm(acceptance~.,data=rs)
insurance <- read.csv("insurance.csv")
head(insurance)
normalize <- function(x) {
return ( (x-min(x)) / (max(x) - min(x))  ) }
insurance_n  <- as.data.frame(lapply(insurance[,c(1,3,4,7)]  ,normalize))
cor( insurance[    , c("age","bmi","children","expenses")] )
m5 <- lm( expenses ~ age + children + bmi +smoker +region,  data=insurance)
m5
#또는
attach(insurance)
lm(expenses ~ .,  data= insurance)
colSums(is.na(insurance))
library(outliers)
grubbs.test(insurance$bmi)
grubbs.flag(insurance$bmi)
grubbs.flag(insurance[,'bmi'])
hist(insurance$expenses)
grubbs.flag <- function(x) {
outliers <- NULL
test <- x
grubbs.result <- grubbs.test(test)
pv <- grubbs.result$p.value
while(pv < 0.05) {
outliers <- c(outliers,as.numeric(strsplit(grubbs.result$alternative," ")[[1]][3]))
test <- x[!x %in% outliers]
grubbs.result <- grubbs.test(test)
pv <- grubbs.result$p.value
}
return(data.frame(X=x,Outlier=(x %in% outliers)))
}
grubbs.flag(insurance$bmi)
insurance_n  <- as.data.frame(lapply(insurance[,c(1,3,4,7)]  ,normalize))
cor( insurance[    , c("age","bmi","children","expenses")] )
install.packages('psych')
library(psych)
pairs.panels(insurance[c('age','bmi','children','expenses')])
dev.new()
pairs.panels(insurance[c('age','bmi','children','expenses')])
m5 <- lm( expenses ~ age + children + bmi +smoker +region,  data=insurance)
m5
#또는
attach(insurance)
lm(expenses ~ .,  data= insurance)
rs_m <- lm(expenses~., data=insurance)
summary(rs_m)
insurance$age2 <- insurance$age^2
insurance
attach(insurance)
lm(expenses ~ .,  data= insurance)
rs_m2 <- lm(expenses ~ .,  data= insurance)
summary(rs_m2)
cor( insurance[    , c("age","bmi","children","expenses",'age2')] )
dev.new()
pairs.panels(insurance[c('age','bmi','children','expenses','age2')])
dev.new()
pairs.panels(insurance[c('age','bmi','children','expenses','age2')])
attach(insurance)
rs_m2 <- lm(expenses ~ .,  data= insurance)
summary(rs_m2)
insurance$bmi30 <- ifelse(insurance$bmi>=30,1,0)
insurance
cor( insurance[    , c("age","bmi","children","expenses",'age2','bmi30')] )
dev.new()
pairs.panels(insurance[c('age','bmi','children','expenses','age2')])
attach(insurance)
rs_m2 <- lm(expenses ~ .,  data= insurance)
summary(rs_m2)
head(insurance)
cor( insurance[    , c("age","bmi","children","expenses",'age2','bmi30')] )
dev.new()
pairs.panels(insurance[c('age','bmi','children','expenses','age2')])
pairs.panels(insurance[c('age','bmi','children','expenses','age2','bmi30')])
# 상호작용 파생변수 추가
rs_m4 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region,data=insurance)
summary(rs_m4)
#264
dev.new()
pairs.panels(insurance[c('age','bmi','children','expenses','age2','bmi30*smoker')])
pairs.panels(insurance[c('age','bmi','children','expenses','age2','bmi30')])
rs_m4 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*age2r+region,data=insurance)
# 상호작용 파생변수 추가
rs_m4 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*age2r+region,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*age2+region,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi*age2+region,data=insurance)
summary(rs_m5)
#264
dev.new()
pairs.panels(insurance[c('age','bmi','children','expenses','age2','bmi30','region')])
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region*bmi,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region*bmi30*smoker,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region*bmi30*smoker*age2,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region*bmi30*smoker,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region*bmi30*age2,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region*bmi30*age,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region*bmi30*smoker,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age2*children+bmi+sex+bmi30*smoker+region*bmi30*smoker,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age2*children+bmi+sex*smoker+bmi30*smoker+region*bmi30*smoker,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age2*children+bmi+sex*smoker+bmi30*smoker,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age2*children+sex*smoker+bmi30*smoker*region,data=insurance)
summary(rs_m5)
head(insurance$children)
head(insurance)
str(insurance$children)
summary(insurance$children)
insurance$child2 <- ifelse(insurance$children>=2,1,0)
cor( insurance[    , c('child2','age2','bmi30')] )
rs_m5 <- lm(expenses ~ age2*region ,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age2*region+smoker*bmi30 ,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age2*region+smoker*bmi30+child2*smoker ,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age2*region+smoker*bmi30+child2*smoker*bmi30 ,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age2*region+smoker*bmi30+child2*smoker*bmi30+bmi30*smoker ,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age2*region*child2+smoker*bmi30+child2*smoker*bmi30+bmi30*smoker ,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age2*region*children+smoker*bmi30+child2*smoker*bmi30+bmi30*smoker ,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age2*bmi30*children+smoker*bmi30+child2*smoker*bmi30+bmi30*smoker ,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age2*bmi*children+smoker*bmi30+child2*smoker*bmi30+bmi30*smoker ,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age2*bmi30*children+smoker*bmi30*region+child2*smoker*bmi30+bmi30*smoker ,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age2*bmi30*children+smoker*bmi30*region+age2*regioni ,data=insurance)
rs_m5 <- lm(expenses ~ age2*bmi30*children+smoker*bmi30*region+age2*region ,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age2*bmi30*children+smoker*bmi30*region+age2*region*smoker ,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age2*bmi30*children^2+smoker*bmi30*region+age2*region*smoker ,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age2*bmi30*children+smoker*bmi30^2*region+age2*region*smoker ,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age2*bmi30*children+smoker*bmi^2*region+age2*region*smoker ,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age2*bmi30*children+smoker*bmi30+age2*region*smoker ,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region*smoker ,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region*smoker*sex ,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi^2*sex+sex+bmi30*smoker+region*smoker*sex ,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi^2*sex+sex+bmi30*smoker+region*smoker ,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children^2+bmi^2*sex+sex+bmi30*smoker+region*smoker ,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ children^2,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ children^2*smoker,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ children^2*smoker+smoker*bmi30,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ children^2*smoker+smoker*bmi30+age2*bmi30,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ children^2*smoker+smoker*bmi30+age2*bmi30*smoker,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ children^2*smoker+smoker*bmi30+age2*bmi30*smoker*region,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ children^2*smoker*bmi30+smoker*bmi30+age2*bmi30*smoker,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region*bmi30*smoker*age2,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ sex+bmi30*smoker+region*bmi30*smoker*age2,data=insurance)
summary(rs_m5)
age+age2+children+bmi+
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region*bmi30*smoker*age2,data=insurance)
summary(rs_m5)
insurance$region2 <- ifelse(insurance$region=='northsouth',1,0)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region2*bmi30*smoker*age2,data=insurance)
summary(rs_m5)
insurance$region2 <- ifelse(insurance$region=='northwest',1,0)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region2*bmi30*smoker*age2,data=insurance)
summary(rs_m5)
str(insurance$region)
summary(insurance$region)
str(insurance$region)
insurance$region2 <- ifelse(insurance$region=='northeast',1,0)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region2*bmi30*smoker*age2,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region2*bmi30*,data=insurance)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region2*bmi30,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region2*smoker,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region2*smoker*bmi30,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region2*smoker*age2,data=insurance)
summary(rs_m5)
insurance$region2 <- ifelse(insurance$region=='southwest',1,0)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region2,data=insurance)
summary(rs_m5)
insurance$region2 <- ifelse(insurance$region=='southeast',1,0)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region2,data=insurance)
summary(rs_m5)
insurance$region2 <- ifelse(insurance$region=='northwest',1,0)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region2,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region2*bmi30*smoker,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region2*smoker,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region2*smoker*children,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region2*children,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region2*child2,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region2*child2*bmi30,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region2*child2*bmi,data=insurance)
summary(rs_m5)
insurance$region2 <- ifelse(insurance$region=='northeast',1,0)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region2*child2*bmi,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region2*child2*bmi30,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region2*children,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region2*children*sex,data=insurance)
summary(rs_m5)
insurance$child2 <- ifelse(insurance$children>=1,1,0)
cor( insurance[    , c('child2','age2','bmi30')] )
insurance$child2 <- ifelse(insurance$children>=3,1,0)
cor( insurance[    , c('child2','age2','bmi30')] )
cor( insurance[    , c('child2','age2','bmi30','expenses')] )
insurance$child2 <- ifelse(insurance$children>=2,1,0)
cor( insurance[    , c('child2','age2','bmi30','expenses')] )
insurance$child2 <- ifelse(insurance$children>=1,1,0)
cor( insurance[    , c('child2','age2','bmi30','expenses')] )
insurance$child2 <- ifelse(insurance$children=0,1,0)
cor( insurance[    , c('child2','age2','bmi30','expenses')] )
insurance$child2 <- ifelse(insurance$children==0,1,0)
cor( insurance[    , c('child2','age2','bmi30','expenses')] )
insurance$region2 <- ifelse(insurance$region=='northeast',1,0)
cor( insurance[    , c('child2','age2','bmi30','expenses')] )
cor( insurance[    , c('child2','age2','bmi30','region2','expenses')] )
insurance$region2 <- ifelse(insurance$region=='northwest',1,0)
cor( insurance[    , c('child2','age2','bmi30','region2','expenses')] )
insurance$region2 <- ifelse(insurance$region=='southwest',1,0)
cor( insurance[    , c('child2','age2','bmi30','region2','expenses')] )
insurance$region2 <- ifelse(insurance$region=='southeast',1,0)
cor( insurance[    , c('child2','age2','bmi30','region2','expenses')] )
insurance$child2 <- ifelse(insurance$children==1,1,0)
cor( insurance[    , c('child2','age2','bmi30','expenses')] )
insurance$child2 <- ifelse(insurance$children==2,1,0)
cor( insurance[    , c('child2','age2','bmi30','expenses')] )
insurance$child2 <- ifelse(insurance$children==3,1,0)
cor( insurance[    , c('child2','age2','bmi30','expenses')] )
insurance$child2 <- ifelse(insurance$children==4,1,0)
cor( insurance[    , c('child2','age2','bmi30','expenses')] )
insurance$child2 <- ifelse(insurance$children==5,1,0)
cor( insurance[    , c('child2','age2','bmi30','expenses')] )
insurance$child2 <- ifelse(insurance$children==3,1,0)
cor( insurance[    , c('child2','age2','bmi30','expenses')] )
insurance$region2 <- ifelse(insurance$region=='southeast',1,0)
cor( insurance[    , c('child2','age2','bmi30','region2','expenses')] )
cor( insurance[    , c('child2','age2','bmi30','region2','sex','expenses')] )
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region2*child2*sex,data=insurance)
summary(rs_m5)
insurance$sex2 <- ifelse(insurance$sex=='female',1,0)
cor( insurance[    , c('child2','age2','bmi30','region2','sex2','expenses')] )
insurance$sex2 <- ifelse(insurance$sex=='male',1,0)
cor( insurance[    , c('child2','age2','bmi30','region2','sex2','expenses')] )
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker+region2*child2*sex2,data=insurance)
summary(rs_m5)
insurance$child2 <- ifelse(insurance$children==2,1,0)
summary(insurance$age)
insurance$age3 <- ifelse(insurance$age>=39,1,0)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker*age3+region2*child2*sex2,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker*age3*sex2,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*smoker*age3*child2,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+bmi30*age3*child2,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+smoker*age3*child2,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+smoker*age3*child2+smoker*bmi30*child2,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+smoker*age3*child2+smoker*bmi30*child2*age3,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+smoker*age3*child2+smoker*bmi30*child2*age3*region2,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+smoker*bmi30*child2*age3*region2,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+bmi+smoker*bmi30*child2*age3*region2,data=insurance)
summary(rs_m5)
insurance$region2 <- ifelse(insurance$region == "northeast", 1, 0)
insurance
model_yj <- lm(expenses ~ age + age2 + children + bmi + sex + bmi30*smoker, region2*age, data=insurance)
summary(model_yj)
model_yj <- lm(expenses ~ age + age2 + children + bmi + sex + bmi30*smoker+region2*age, data=insurance)
summary(model_yj)
model_yj <- lm(expenses ~ age + age2 + children + bmi + sex + bmi30*smoker*region2*age, data=insurance)
summary(model_yj)
model_yj <- lm(expenses ~ age + age2 + children + bmi + sex + bmi30*smoker+region2*age, data=insurance)
summary(model_yj)
rs_m5 <- lm(expenses ~ age+bmi+smoker*bmi30*child2*age3*region2,data=insurance)
summary(rs_m5)
insurance$region2 <- ifelse(insurance$region=='southeast',1,0)
insurance$sex2 <- ifelse(insurance$sex=='male',1,0)
cor( insurance[    , c('child2','age2','bmi30','region2','sex2','expenses')] )
rs_m5 <- lm(expenses ~ age+bmi+smoker*bmi30*child2*age3*region2,data=insurance)
summary(rs_m5)
rs_m5 <- lm(expenses ~ age+age2+children+bmi+sex+smoker*age3*child2+smoker*bmi30*child2*age3*region2,data=insurance)
summary(rs_m5)
install.packages("car")
library(car)
test <- read.csv('test_vif1.csv')
test
cor(test[,c('아이큐','공부시간')])
test <- test[,-1]
m1 <- lm('시험점수'~. data=test)
m1
m1 <- lm(test$시험점수~. data=test)
m1
summary(m1)
test
m1 <- lm(test$시험점수~. data=test)
m1 <- lm(test$시험점수~. data=test)
m1 <- lm(test$시험점수~. data=test)
m1 <- lm(test$시험점수~., data=test)
summary(m1)
vif(m1)
test2 <- read.csv('test_vif2.csv')
test2
test2 <- test2[,-1]
test
test2
test_m <- lm(test2$시험점수~., data=test2)
test_m
vif(test_m)
vif(test_m) > 15
vif(test_m)
vif(test_m) > 15
summary(test_m)
vif(test_m)
vif(test_m) > 15
hist(insurance$expenses)
str(insurance$expenses)
summary(insurance$expenses)
vif(rs_m2)
insurance <- read.csv("insurance.csv")
normalize <- function(x) {
return ( (x-min(x)) / (max(x) - min(x))  ) }
insurance_n  <- as.data.frame(lapply(insurance[,c(1,3,4,7)]  ,normalize))
cor( insurance[    , c("age","bmi","children","expenses")] )
m5 <- lm( expenses ~ age + children + bmi +smoker +region,  data=insurance)
m5
vif(m5)
vif(test_m)
vif(test_m) > 15 # 아이큐, 등급평균
summary(test_m)
test <- read.csv('test_vif1.csv')
test
test <- test[,-1]
